[gd_scene load_steps=34 format=4 uid="uid://b13vwyaewc6tm"]

[ext_resource type="PackedScene" uid="uid://yjjkhh7sb3m" path="res://general/debug/debug_menu.tscn" id="1_6gk0q"]
[ext_resource type="PackedScene" uid="uid://b7gh3a6eb03y0" path="res://ui/resource_display/resource_display.tscn" id="1_a47p7"]
[ext_resource type="Script" uid="uid://857d3xpx3leu" path="res://levels/level.gd" id="1_xaem1"]
[ext_resource type="FontFile" uid="uid://dvvpbm6cwnrjq" path="res://assets/fonts/Pixelify_Sans/static/PixelifySans-Regular.ttf" id="2_0o44c"]
[ext_resource type="PackedScene" uid="uid://dy700bwdrorh4" path="res://entities/characters/player.tscn" id="2_0wynk"]
[ext_resource type="TileSet" uid="uid://chyut4bk5txdn" path="res://tilesets/dungeon_terrain.tres" id="2_5krfb"]
[ext_resource type="PackedScene" uid="uid://bqwtq0th0xf8r" path="res://ui/trap_selection/trap_selection.tscn" id="2_f3iph"]
[ext_resource type="Script" uid="uid://ixlv8o45pmwu" path="res://levels/map.gd" id="2_vrunm"]
[ext_resource type="Script" uid="uid://bmmeaqfs15cos" path="res://levels/intro_prompt.gd" id="3_wn8u6"]
[ext_resource type="Script" uid="uid://cjudhtx3rtd6j" path="res://levels/enemy_path.gd" id="4_ohqux"]
[ext_resource type="Texture2D" uid="uid://bo33kmayvd6bc" path="res://assets/ui/highlight/tile_highlight_b.png" id="5_1b2a2"]
[ext_resource type="Shader" uid="uid://bu07te3gng807" path="res://general/shaders/color_vignette.gdshader" id="5_100t0"]
[ext_resource type="PackedScene" uid="uid://vcm1xbqwt4l8" path="res://entities/characters/enemy/warrior/enemy_warrior.tscn" id="5_ohqux"]
[ext_resource type="Script" uid="uid://dj31ygtup3hge" path="res://levels/warning_overlay.gd" id="5_sqy2y"]
[ext_resource type="PackedScene" uid="uid://qsptluvvputt" path="res://entities/objects/minion_door.tscn" id="6_a47p7"]
[ext_resource type="PackedScene" uid="uid://dufrxn7xbtkv6" path="res://ui/onscreen_controls/onscreen_controls.tscn" id="8_qxrr7"]
[ext_resource type="Script" uid="uid://bnkygjicc4o7x" path="res://managers/entity_manager.gd" id="10_200ie"]
[ext_resource type="PackedScene" uid="uid://dbk3p3q8hhi52" path="res://general/camera/shaky_cam.tscn" id="10_vehgu"]
[ext_resource type="PackedScene" uid="uid://b3bvpi5igruyf" path="res://entities/objects/treasure/treasure.tscn" id="13_cnwds"]

[sub_resource type="LabelSettings" id="LabelSettings_wn8u6"]
font = ExtResource("2_0o44c")
outline_color = Color(0.09411765, 0.078431375, 0.14509805, 1)
shadow_color = Color(0.09411765, 0.078431375, 0.14509805, 0.4117647)
shadow_offset = Vector2(0, 1)

[sub_resource type="Curve" id="Curve_sqy2y"]
_data = [Vector2(0, 0), 0.0, 0.008302576, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="ShaderMaterial" id="ShaderMaterial_sqy2y"]
shader = ExtResource("5_100t0")
shader_parameter/vignette_intensity = 0.3
shader_parameter/vignette_opacity = 1.0
shader_parameter/vignette_rgb = Color(1, 0, 0, 1)

[sub_resource type="AtlasTexture" id="AtlasTexture_qxrr7"]
atlas = ExtResource("5_1b2a2")
region = Rect2(96, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_1b2a2"]
atlas = ExtResource("5_1b2a2")
region = Rect2(0, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_6gk0q"]
atlas = ExtResource("5_1b2a2")
region = Rect2(16, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_cnwds"]
atlas = ExtResource("5_1b2a2")
region = Rect2(32, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_0o44c"]
atlas = ExtResource("5_1b2a2")
region = Rect2(48, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_wn8u6"]
atlas = ExtResource("5_1b2a2")
region = Rect2(64, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_200ie"]
atlas = ExtResource("5_1b2a2")
region = Rect2(80, 0, 16, 16)

[sub_resource type="SpriteFrames" id="SpriteFrames_vehgu"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_qxrr7")
}],
"loop": true,
"name": &"default",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_1b2a2")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_6gk0q")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_cnwds")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_0o44c")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_wn8u6")
}],
"loop": true,
"name": &"place",
"speed": 10.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_200ie")
}],
"loop": true,
"name": &"remove",
"speed": 5.0
}]

[sub_resource type="TileSetScenesCollectionSource" id="TileSetScenesCollectionSource_f3iph"]
resource_name = "Traps"

[sub_resource type="TileSet" id="TileSet_vehgu"]
sources/0 = SubResource("TileSetScenesCollectionSource_f3iph")

[sub_resource type="Curve2D" id="Curve2D_x46hq"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 104, 152, 0, 0, 0, 0, 216, 152, 0, 0, 0, 0, 216, 56, 0, 0, 0, 0, 72, 56, 0, 0, 0, 0, 72, -40, 0, 0, 0, 0, 255, -40)
}
point_count = 6

[node name="Level" type="Node2D"]
y_sort_enabled = true
script = ExtResource("1_xaem1")

[node name="OnscreenControls" parent="." instance=ExtResource("8_qxrr7")]

[node name="ResourceDisplay" parent="." instance=ExtResource("1_a47p7")]

[node name="Label" type="Label" parent="ResourceDisplay"]
visible = false
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
text = "Protect Your Treasure!"
label_settings = SubResource("LabelSettings_wn8u6")
horizontal_alignment = 1
vertical_alignment = 1
script = ExtResource("3_wn8u6")

[node name="WarningOverlay" type="CanvasLayer" parent="."]
script = ExtResource("5_sqy2y")
warning_curve = SubResource("Curve_sqy2y")

[node name="ColorVignette" type="ColorRect" parent="WarningOverlay"]
visible = false
material = SubResource("ShaderMaterial_sqy2y")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="TrapSelection" parent="." node_paths=PackedStringArray("map") instance=ExtResource("2_f3iph")]
map = NodePath("../Map")

[node name="DebugMenu" parent="." instance=ExtResource("1_6gk0q")]

[node name="Map" type="Node2D" parent="."]
y_sort_enabled = true
script = ExtResource("2_vrunm")

[node name="Ground" type="TileMapLayer" parent="Map"]
z_index = -10
tile_map_data = PackedByteArray("AAARAAgAAAACAAIAAAARAAcAAAARAAgAAAARAAYAAAARAAcAAAARAAUAAAADAAIABAAQAAgAAAACAAIAAAAQAAcAAAADAAMAAAAQAAYAAAACAAIAAAAQAAUAAAACAAMAAQAPAAgAAAACAAIAAAAPAAcAAAACAAIAAAAPAAYAAAAEAAMAAAAPAAUAAAARAAYAAQAOAAgAAAACAAIAAAAOAAcAAAACAAIAAAAOAAYAAAADAAQAAAAOAAUAAAARAAkAAAAOAAQAAAAQAAkAAAANAAgAAAACAAQAAAANAAcAAAACAAIAAAANAAYAAAACAAMAAAANAAUAAAACAAQAAAANAAQAAAACAAQAAAAMAAgAAAARAAcAAgAMAAcAAAARAAYAAQAMAAYAAAARAAcAAgAMAAUAAAARAAgAAAAMAAQAAAACAAIAAAALAAgAAAAEAAIAAQALAAQAAAADAAMAAgAKAAgAAAADAAIABAAKAAQAAAARAAYAAQAJAAgAAAADAAMAAgAJAAQAAAAEAAIAAQAIAAgAAAACAAIAAAAIAAQAAAARAAcAAAAHAAgAAAADAAQAAAAHAAQAAAADAAIABAAGAAgAAAAEAAQAAAAGAAQAAAARAAcAAgAGAAMAAAACAAIAAAAGAAIAAAACAAIAAAAFAAgAAAACAAMAAAAFAAQAAAADAAQAAAAFAAMAAAAEAAMAAgAFAAIAAAARAAcAAgAEAAQAAAADAAIAAAAEAAMAAAADAAQAAQAEAAIAAAADAAIAAAADAAQAAAACAAMAAAADAAMAAAADAAMAAgAOAAMAAAAEAAMAAAANAAMAAAACAAIAAAAMAAMAAAADAAMAAAAHAAMAAAAEAAQAAQALAAMAAAARAAcAAAAKAAMAAAACAAIAAAAJAAMAAAACAAIAAAAIAAMAAAAEAAQAAAACAAQAAAACAAIAAAACAAIAAAADAAIAAAACAAMAAAACAAIAAAADAAIAAAACAAIAAAARAAkAAAACAAMAAQAQAAkAAAADAAQAAQAPAAkAAAAEAAIAAAAOAAkAAAARAAkAAQANAAkAAAACAAMAAAAMAAkAAAAEAAIAAQALAAkAAAACAAIAAAAKAAkAAAACAAIAAAAJAAkAAAADAAQAAAAIAAkAAAACAAIAAAAHAAkAAAAEAAMAAAAGAAkAAAARAAcAAgAFAAkAAAAQAAkAAAAOAAIAAAAEAAMAAAANAAIAAAAEAAMAAAAMAAIAAAADAAQAAAALAAIAAAADAAQAAAAKAAIAAAAEAAIAAQAJAAIAAAAEAAQAAAAIAAIAAAADAAQAAQAHAAIAAAARAAgAAAAGAAEAAAACAAMAAQAGAAAAAAAEAAMAAgAGAP//AAAEAAMAAAAGAP7/AAADAAMAAgAGAP3/AAADAAQAAAAFAAEAAAACAAIAAAAFAAAAAAAEAAIAAAAFAP//AAACAAIAAAAFAP7/AAACAAIAAAAFAP3/AAADAAIAAAAEAAEAAAARAAgAAAAEAAAAAAACAAIAAAAEAP//AAARAAcAAgAEAP7/AAARAAgAAQAEAP3/AAACAAIAAAADAAEAAAAEAAMAAAADAAAAAAARAAcAAgADAP//AAACAAIAAAADAP7/AAACAAIAAAADAP3/AAACAAMAAAACAAEAAAAQAAkAAAACAAAAAAACAAIAAAACAP//AAACAAIAAAACAP7/AAACAAMAAQACAP3/AAACAAMAAAAOAP7/AAAQAAkAAAAOAP3/AAAEAAQAAAANAP7/AAADAAQAAQANAP3/AAACAAIAAAAMAP7/AAADAAQAAQAMAP3/AAACAAIAAAALAP7/AAADAAIAAAALAP3/AAAEAAMAAAAKAP7/AAAEAAQAAQAKAP3/AAACAAIAAAAJAP7/AAADAAIAAAAJAP3/AAADAAQAAAAIAP7/AAARAAYAAQAIAP3/AAADAAIAAAAHAP7/AAAEAAQAAAAHAP3/AAADAAMAAAARAP7/AAARAAgAAQARAP3/AAAEAAMAAAAQAP7/AAACAAMAAQAQAP3/AAAEAAIAAQAPAP7/AAACAAIAAAAPAP3/AAARAAcAAAARAPz/AAAEAAIAAAAQAPz/AAACAAIAAAAPAPz/AAACAAIAAAAOAPz/AAACAAIAAAANAPz/AAADAAIAAAAMAPz/AAAQAAkAAAALAPz/AAACAAIAAAAKAPz/AAARAAkAAQAJAPz/AAACAAIAAAAIAPz/AAACAAIAAAAHAPz/AAADAAMAAAAGAPz/AAACAAMAAAAFAPz/AAAEAAIAAQAEAPz/AAAEAAMAAAADAPz/AAADAAMAAgACAPz/AAAEAAIAAAARAAoAAAACAAIAAAAQAAoAAAARAAkAAQAPAAoAAAARAAcAAgAOAAoAAAARAAcAAgANAAoAAAACAAIAAAAMAAoAAAAEAAMAAAALAAoAAAADAAQAAAAKAAoAAAACAAIAAAAJAAoAAAADAAMAAgAIAAoAAAACAAIAAAAHAAoAAAACAAIAAAAGAAoAAAARAAkAAAAFAAoAAAAEAAQAAAA=")
tile_set = ExtResource("2_5krfb")

[node name="HighlightBox" type="AnimatedSprite2D" parent="Map/Ground"]
sprite_frames = SubResource("SpriteFrames_vehgu")
autoplay = "default"

[node name="EnemyTrack" type="TileMapLayer" parent="Map"]
z_index = -10
tile_map_data = PackedByteArray("AAAEAAMAAAACAAQAAAAFAAMAAAACAAQAAAAGAAMAAAACAAQAAAAHAAMAAAACAAQAAAAIAAMAAAACAAQAAAAJAAMAAAACAAQAAAAKAAMAAAACAAQAAAALAAMAAAACAAQAAAAMAAMAAAACAAQAAAANAAMAAAACAAQAAAANAAQAAAACAAQAAAANAAUAAAACAAQAAAANAAYAAAACAAQAAAANAAcAAAACAAQAAAANAAgAAAACAAQAAAANAAkAAAACAAQAAAAMAAkAAAACAAQAAAALAAkAAAACAAQAAAAKAAkAAAACAAQAAAAJAAkAAAACAAQAAAAIAAkAAAACAAQAAAAHAAkAAAACAAQAAAAGAAkAAAACAAQAAAAEAAIAAAACAAQAAAAEAAEAAAACAAQAAAAEAAAAAAACAAQAAAAEAP//AAACAAQAAAAEAP7/AAACAAQAAAAEAP3/AAACAAQAAAAQAP3/AAACAAQAAAAPAP3/AAACAAQAAAAOAP3/AAACAAQAAAANAP3/AAACAAQAAAAMAP3/AAACAAQAAAALAP3/AAACAAQAAAAKAP3/AAACAAQAAAAJAP3/AAACAAQAAAAIAP3/AAACAAQAAAAHAP3/AAACAAQAAAAGAP3/AAACAAQAAAAFAP3/AAACAAQAAAA=")
tile_set = ExtResource("2_5krfb")

[node name="Holes" type="TileMapLayer" parent="Map"]
z_index = -10
tile_map_data = PackedByteArray("AAAPAAgAAAAPAAIAAAAQAAgAAAAPAAIAAAAPAAcAAAAPAAIAAAAQAAcAAAAPAAIAAAAPAAkAAAAPAAIAAAAQAAkAAAAPAAIAAAAPAAYAAAAQAAIAAAAQAAYAAAAQAAEAAAA=")
tile_set = ExtResource("2_5krfb")

[node name="Traps" type="TileMapLayer" parent="Map"]
y_sort_enabled = true
tile_set = SubResource("TileSet_vehgu")

[node name="TrapsHover" type="TileMapLayer" parent="Map"]
y_sort_enabled = true
tile_set = SubResource("TileSet_vehgu")

[node name="Walls" type="TileMapLayer" parent="Map"]
y_sort_enabled = true
tile_map_data = PackedByteArray("AAAHAAUAAAABAAcAAAAGAAUAAAACAAEAAAAFAAUAAAADAAkAAAAEAAUAAAAEAAUAAAADAAUAAAAEAAEAAAACAAUAAAAEAAUAAAABAAUAAAABAAUAAAAPAAQAAAABAAUAAAAPAAMAAAABAAIAAAASAAQAAAAFAAEAAAARAAQAAAADAAEAAAAQAAQAAAADAAEAAAALAAUAAAAFAAEAAAAKAAUAAAACAAEAAAAJAAUAAAADAAUAAAAIAAUAAAAEAAEAAAALAAYAAAAFAAIAAAAEAAcAAAABAAEAAAAEAAkAAAABAAQAAAAEAAgAAAAFAAQAAAABAAIAAAAFAAIAAAABAAMAAAAFAAQAAAABAAQAAAABAAIAAAASAAUAAAAFAAQAAAASAAYAAAABAAIAAAASAAcAAAAFAAMAAAASAAgAAAAFAAQAAAASAAkAAAAFAAMAAAAFAAcAAAACAAUAAAAGAAcAAAADAAUAAAAHAAcAAAAEAAEAAAAIAAcAAAAEAAEAAAAJAAcAAAACAAkAAAAKAAcAAAAEAAEAAAALAAcAAAAFAAUAAAAEAAoAAAABAAIAAAASAAoAAAABAAMAAAABAAEAAAABAAIAAAABAAAAAAAFAAIAAAABAP//AAAFAAMAAAABAP7/AAABAAIAAAABAP3/AAABAAMAAAABAPz/AAAFAAMAAAABAPv/AAABAAEAAAAPAAIAAAABAAIAAAAPAAEAAAAFAAEAAAAOAAEAAAACAAkAAAANAAEAAAADAAUAAAAMAAEAAAACAAUAAAALAAEAAAADAAUAAAAKAAEAAAAEAAUAAAAJAAEAAAAEAAUAAAAIAAEAAAAEAAUAAAAHAAEAAAABAAUAAAAHAAAAAAAFAAIAAAAHAP//AAABAAEAAAASAP//AAAFAAUAAAARAP//AAACAAkAAAAQAP//AAADAAUAAAAPAP//AAACAAUAAAAOAP//AAADAAEAAAANAP//AAAEAAUAAAAMAP//AAAEAAUAAAALAP//AAADAAUAAAAKAP//AAACAAEAAAAJAP//AAACAAUAAAAIAP//AAADAAUAAAASAPv/AAAFAAEAAAARAPv/AAACAAEAAAAQAPv/AAAEAAUAAAAPAPv/AAADAAUAAAAOAPv/AAACAAkAAAANAPv/AAACAAEAAAAMAPv/AAACAAEAAAALAPv/AAADAAEAAAAKAPv/AAAEAAEAAAAJAPv/AAACAAUAAAAIAPv/AAADAAUAAAAHAPv/AAAEAAEAAAAGAPv/AAADAAEAAAAFAPv/AAAEAAEAAAAEAPv/AAAEAAEAAAADAPv/AAAEAAUAAAACAPv/AAAEAAUAAAASAP7/AAAFAAMAAAASAP3/AAAFAAQAAAASAPz/AAABAAQAAAAEAAsAAAABAAUAAAAFAAsAAAAEAAEAAAAGAAsAAAACAAkAAAAHAAsAAAACAAkAAAALAAsAAAADAAUAAAAMAAsAAAADAAEAAAANAAsAAAAEAAUAAAAOAAsAAAAEAAEAAAAPAAsAAAADAAUAAAAQAAsAAAADAAUAAAARAAsAAAAEAAEAAAASAAsAAAAFAAUAAAAIAAsAAAAEAAEAAAAJAAsAAAAEAAUAAAAKAAsAAAACAAUAAAA=")
tile_set = ExtResource("2_5krfb")

[node name="Entities" type="Node2D" parent="."]
y_sort_enabled = true
script = ExtResource("10_200ie")

[node name="Player" parent="Entities" instance=ExtResource("2_0wynk")]
position = Vector2(83, 44)

[node name="EnemyPath" type="Path2D" parent="Entities"]
y_sort_enabled = true
curve = SubResource("Curve2D_x46hq")
script = ExtResource("4_ohqux")
enemy_scene = ExtResource("5_ohqux")
spawn_interval = 6.0

[node name="MinionDoor2" parent="Entities" instance=ExtResource("6_a47p7")]
position = Vector2(184, 32)

[node name="MinionDoor" parent="Entities" instance=ExtResource("6_a47p7")]
position = Vector2(56, -64)

[node name="ShakyCam" parent="." node_paths=PackedStringArray("target") instance=ExtResource("10_vehgu")]
target = NodePath("../Entities/Player")

[node name="Stash" parent="." instance=ExtResource("13_cnwds")]
position = Vector2(268, -40)
